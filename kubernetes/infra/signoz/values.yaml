namespace: signoz
serverSideApply: true

# Ignore Kubernetes runtime defaults that cause perpetual drift
ignoreDifferences:
  # ClickHouse operator metrics-exporter adds divisor: "0" defaults to resourceFieldRef
  - group: apps
    kind: Deployment
    name: signoz-clickhouse-operator
    jqPathExpressions:
      - .spec.template.spec.containers[].env[].valueFrom.resourceFieldRef.divisor
  # StatefulSets get runtime defaults (revisionHistoryLimit, persistentVolumeClaimRetentionPolicy)
  - group: apps
    kind: StatefulSet
    name: signoz
    jqPathExpressions:
      - .spec.revisionHistoryLimit
      - .spec.persistentVolumeClaimRetentionPolicy
  - group: apps
    kind: StatefulSet
    name: signoz-zookeeper
    jqPathExpressions:
      - .spec.revisionHistoryLimit
      - .spec.persistentVolumeClaimRetentionPolicy

tailscale-ingress:
  enabled: true
  ingresses:
    - name: tailscale
      hostname: signoz
      service:
        name: signoz
        port: 8080

# API token for loading dashboards/alerts via GitOps
# Create token in SigNoz: Settings → API Tokens → Generate
# Store in Bitwarden and update the secret ID below
bitwarden-secret:
  enabled: true
  secrets:
    - name: signoz-api-token
      data:
        token: "fa8aa5d0-f1d2-4de3-a1a8-b3c9003c2a52"

signoz:
  clusterName: homelab

  clickhouse:
    persistence:
      enabled: true
      size: 20Gi
    zookeeper:
      heapSize: 256

  signoz:
    persistence:
      enabled: true
      size: 1Gi
