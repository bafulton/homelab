namespace: mosquitto

# Ignore deployment strategy - we manually set Recreate for RWO PVC compatibility
# (upstream chart doesn't support strategy configuration)
ignoreDifferences:
  - group: apps
    kind: Deployment
    jsonPointers:
      - /spec/strategy

mosquitto:
  # MetalLB LoadBalancer for LAN access (Theengs Gateway, etc.)
  service:
    type: LoadBalancer
    annotations:
      metallb.io/loadBalancerIPs: "192.168.0.202"
    ports:
      mqtt:
        enabled: true
        port: 1883

  # Broker configuration
  config:
    # Allow anonymous - LAN access only, no external exposure
    # Theengs Gateway and Home Assistant will connect without auth
    allowAnonymous: true
    logLevel: information

  # Persistence for retained messages and subscriptions
  persistence:
    enabled: true
    storageClass: longhorn-emmc
    size: 1Gi
