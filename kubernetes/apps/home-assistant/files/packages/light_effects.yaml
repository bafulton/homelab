# Light Effects Package
# Cycles smart bulbs through color themes via dashboard buttons

input_select:
  light_effect:
    name: Light Effect
    options:
      - "Off"
      - Rainbow
      - Love
      - Ocean
      - Forest
      - Sunset
      - Aurora
      - Candlelight
    initial: "Off"
    icon: mdi:palette

automation:
  - alias: "Color Cycle Effects"
    id: color_cycle_effects
    description: "Cycles room lights through colors based on selected effect"
    trigger:
      - platform: time_pattern
        seconds: "/5"
    condition:
      - condition: not
        conditions:
          - condition: state
            entity_id: input_select.light_effect
            state: "Off"
    action:
      - choose:
          # Rainbow - full spectrum (~45 sec cycle)
          - conditions:
              - condition: state
                entity_id: input_select.light_effect
                state: "Rainbow"
            sequence:
              - service: light.turn_on
                target:
                  area_id: bedroom
                data:
                  hs_color: "{{ [(now().timestamp() * 8 | int % 360), 100] }}"
                  transition: 4

          # Love - reds and pinks (hue 330-30, ~17 sec cycle)
          - conditions:
              - condition: state
                entity_id: input_select.light_effect
                state: "Love"
            sequence:
              - service: light.turn_on
                target:
                  area_id: bedroom
                data:
                  hs_color: "{{ [(330 + (now().timestamp() * 3.6 | int % 60)) % 360, 100] }}"
                  transition: 4

          # Ocean - blues and cyans (hue 180-240, ~25 sec cycle)
          - conditions:
              - condition: state
                entity_id: input_select.light_effect
                state: "Ocean"
            sequence:
              - service: light.turn_on
                target:
                  area_id: bedroom
                data:
                  hs_color: "{{ [180 + (now().timestamp() * 2.4 | int % 60), 100] }}"
                  transition: 4

          # Forest - greens (hue 90-150, ~25 sec cycle)
          - conditions:
              - condition: state
                entity_id: input_select.light_effect
                state: "Forest"
            sequence:
              - service: light.turn_on
                target:
                  area_id: bedroom
                data:
                  hs_color: "{{ [90 + (now().timestamp() * 2.4 | int % 60), 80] }}"
                  transition: 4

          # Sunset - warm reds, oranges, yellows (hue 0-45, ~25 sec cycle)
          - conditions:
              - condition: state
                entity_id: input_select.light_effect
                state: "Sunset"
            sequence:
              - service: light.turn_on
                target:
                  area_id: bedroom
                data:
                  hs_color: "{{ [(now().timestamp() * 1.8 | int % 45), 100] }}"
                  transition: 4

          # Aurora - alternating greens (90-150) and purples (270-330, ~50 sec cycle)
          - conditions:
              - condition: state
                entity_id: input_select.light_effect
                state: "Aurora"
            sequence:
              - service: light.turn_on
                target:
                  area_id: bedroom
                data:
                  hs_color: >
                    {% set t = now().timestamp() * 2.4 | int % 120 %}
                    {{ [90 + t if t < 60 else 270 + (t - 60), 80] }}
                  transition: 4

          # Candlelight - warm flickering yellows/oranges (hue 25-45, ~20 sec cycle)
          - conditions:
              - condition: state
                entity_id: input_select.light_effect
                state: "Candlelight"
            sequence:
              - service: light.turn_on
                target:
                  area_id: bedroom
                data:
                  hs_color: "{{ [25 + (now().timestamp() * 1.0 | int % 20), 60] }}"
                  brightness_pct: "{{ 70 + (now().timestamp() | int % 20) }}"
                  transition: 4

script:
  reset_lights_to_normal:
    alias: "Reset Lights to Normal"
    icon: mdi:lightbulb
    sequence:
      - service: input_select.select_option
        target:
          entity_id: input_select.light_effect
        data:
          option: "Off"
      - service: light.turn_on
        target:
          area_id: bedroom
        data:
          color_temp_kelvin: 3000
          brightness_pct: 100
          transition: 2
